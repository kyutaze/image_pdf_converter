## 目的
EPUBファイル（固定レイアウト形式）の目次をPDFファイル埋め込み用にCSVファイルに出力するPythonスクリプトを生成する。

## 出力レイアウト
- CSV形式で出力する。各項目は二重引用符で括る。
- 出力項目は以下のとおり。
  - level（固定値：1）
  - title
  - page

## 処理手順
1. EPUB内の **.opf** を解析する。
- **spine要素** から **itemref要素** の **idref属性値** をページ順に取得する。また、1から始まる連番を付与する。
- 取得した **idref属性値** で **item要素** の **id属性** を検索し、**href属性値** を取得する。（xhtmlファイル名が取得される）
- 以下の内部テーブルを作成する。
  - **itemref要素** の **idref属性値**
  - 付与した連番
- 作成した内部テーブルをログ出力する。

2. EPUB内の目次データ（例：toc.ncx）を解析し、CSVファイルを生成する。
- CSVファイルのtitle欄には、**navLabel要素** 内 **text要素値** を設定する。
- CSVファイルのpage欄には、**content要素** の **src属性値** をキーとして内部テーブルを検索した結果得られる **連番** を設定する。
- CSVファイルは、EPUBファイルと同じディレクトリに保存する。ファイル名は EPUBファイルのbasename + "_toc.csv" とする。
- なお、**--skip-cover** オプションの指定有無により処理を変える。
  - **--skip-cover** が指定されていない場合は、**spine要素** の1つ目から処理する。連番も1つ目を1として付番する。
  - **--skip-cover** が指定された場合、 **spine要素** の1つ目はスキップして2つ目から処理する。連番も2つ目を1として付番する。

## コマンドラインオプション
- **--input-epub** オプション：目次抽出の対象となるEPUBファイルのパス。必須引数。
- **--skip-cover** フラグ：指定された場合は表紙をスキップして処理する。

## EPUBファイルサンプル
- sample.epub
